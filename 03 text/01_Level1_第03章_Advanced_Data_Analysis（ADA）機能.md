# 📘 Level 1: 基本機能テキスト

## 第3章: Advanced Data Analysis（ADA）機能

以下、研修内容をブラッシュアップしました。演習問題をシンプルにし、参照ファイルのイメージを追加しました。

### 3-1 Excelデータ分析

| 項目 | 内容 |
|------|------|
| **学習目標** | Advanced Data Analysis機能を活用したExcelデータの高度分析技術習得 |
| **対象機能** | ADA + Excel |

#### 📚 この章で学ぶこと

📊 **Advanced Data Analysis（ADA）機能の革新性**

ChatGPT TeamのAdvanced Data Analysis機能は、ChatGPT内部に安全に隔離された実行環境（サンドボックス）を持ち、その中でPythonコードを自動生成・実行することで、従来のデータ分析を飛躍的に進化させます。

ユーザーが「売上データを分析して」と自然な日本語で指示すると、ChatGPTがその意図を理解し、適切なPythonコードを瞬時に生成・実行します。
単なる表計算を超えて、統計分析・機械学習・高度な可視化まで、プログラミング知識なしに一気通貫で実現できます。

ADA機能は、ユーザーがその活用を明示的に宣言する必要がありません。
Excelファイルをアップロードし、分析を依頼するだけで、ChatGPTが自動的にADA機能を起動し、最適な分析手法を選択してコードを生成・実行します。

![ADA機能でPythonコードが自動生成され、データ分析が実行されている画面](https://profab.co.jp/wp-content/uploads/2025/09/txt_chatgpt_ada.png)

さらに、複数のシートを持つExcelファイルの場合、シート選択インターフェースが表示され、必要なシートを選んで個別に分析することができます。
これにより、複雑な表計算データも直感的に操作・分析することが可能です。

![Excelファイルの複数シートから選択して分析できる画面](https://profab.co.jp/wp-content/uploads/2025/09/txt_chatgpt_sheetview.png)

🔧 **ADA機能の主要な特徴**

1. **統計解析と相関分析**
   - 平均値、中央値、標準偏差などの基本統計量の算出
   - データ間の相関係数計算と散布図での可視化
   - 回帰分析による要因分析（例：広告費と売上の関係性）
   - 統計的検定による仮説の検証

3. **データクレンジングと前処理**
   - 重複データの自動検出と削除
   - 欠損値の補完（平均値、中央値、前後の値での補間）
   - 異常値の検出とフラグ付け
   - データの正規化や標準化処理

4. **高度な可視化**
   - ヒートマップによる相関行列の表示
   - 箱ひげ図による分布の可視化
   - 時系列データのトレンド分析グラフ
   - 複数軸グラフによる多角的な分析表示

5. **機械学習とパターン認識**
   - クラスタリングによる顧客セグメンテーション
   - 時系列予測による需要予測や売上予測
   - 分類モデルによる顧客の購買確率予測
   - 異常検知アルゴリズムによる不正取引の発見

🔬 **ADAの作動原理**

ADA機能は、ChatGPT内部の隔離された安全な実行環境（サンドボックス）でPythonコードを自動生成・実行する仕組みです。ユーザーが「売上を分析して」と指示すると、ChatGPTがその意図を理解し、適切なPythonコードを瞬時に生成します。このコードは外部ネットワークから遮断された環境で実行され、NumPy（数値計算）、Pandas（データ処理）、Matplotlib（グラフ作成）などの専門ライブラリを活用して分析を行います。実行結果はAIが解釈し、ビジネス文脈に合わせた説明と共に返されます。セッション終了時には環境が完全に破棄されるため、データの機密性も保証されています。

#### ハンズオン演習

> 💡 **演習の進め方**
>
> 1. 各演習の状況設定を理解する
> 2. 記載されているプロンプト例をそのまま試す
> 3. 出力結果を確認し、より良い結果を得るためにプロンプトを修正します
> 4. 演習1〜3まで完了後、ユースケース例を参考に自業務での活用を検討してください

**【演習1】**

| テーマ | 状況設定 |
|------|------|
| 統計解析と相関分析（広告費と売上の関係を見る） | 広告費と売上がどれくらい関係しているかをざっくり把握する |

**参照ファイル**: [sample_marketing_stats.csv](https://drive.google.com/file/d/1mq39aoZrnrzCMT0NxbwUNnr2RQqHZ1P6/view?usp=sharing)

**プロンプト例**:
```
sample_marketing_stats.csv を読み込み、
1) 全ての数値列の平均、中央値、標準偏差を出す
2) 広告費と売上の関係を散布図で描く
3) 広告費から売上を予測する簡単な計算をして結果を出す
```

※ 平均＝値の合計÷件数  
※ 中央値＝真ん中の値  
※ 標準偏差＝どれくらいバラついているかの指標  
※ 散布図＝点で関係を見るグラフ

**【演習2】**

| テーマ | 状況設定 |
|------|------|
| 重複データの自動検出と整理（商品マスタの品質改善） | 商品データの中に重複や欠けている値があるので、自動で直したい |

**参照ファイル**: [sample_data_quality.csv](https://drive.google.com/file/d/1dVu_L4D3PfqRb6-EkymHWxdczX6UXLn0/view?usp=sharing)

**プロンプト例**:
```
sample_data_quality.csv を読み込み、
1) 全く同じ行を削除して件数を出す
2) 欠けている数値を中央値で補う
3) 明らかに大きすぎる／小さすぎる値を見つけてフラグを付ける
4) 値の分布をグラフで表示する
```

※ 重複＝全く同じ行が2つ以上ある状態  
※ 欠けている値＝空欄やNaN（数値が入っていない）  
※ フラグ＝「ここが怀しい」と印をつけること

**【演習3】**

| テーマ | 状況設定 |
|------|------|
| クラスタリングによる顧客グループ分け | 似た特徴の顧客を自動でグループ分けして特徴を知る |

**参照ファイル**: [sample_customer_segmentation.csv](https://drive.google.com/file/d/1T-9QzG1buFU-LcekSoRqWcIx0I_UERLd/view?usp=sharing)

**プロンプト例**:
```
sample_customer_segmentation.csv を読み込み、
1) 数値項目を使って自動で3つにグループ分けする
2) 各グループの平均値と人数を出す
3) グループごとの違いを簡単に説明する
4) グラフでグループ分けを表示する
```

※ グループ分け（クラスタリング）＝似た人を集める作業  
※ 平均値＝そのグループの典型的な値  
※ グラフ＝位置や色でグループの違いを視覚化

**ユースケース例**：自業務への応用（テーマ別 × 各3例）

学習した内容を次も参考に自業務に生かしてください。

**データ前処理と品質向上**：
- 欠損/外れ/重複の検出と修正案
- 列型推定と単位・表記の統一
- 正規化/エンコーディング方針の提案

**基礎集計と探索（EDA）**：
- 記述統計とヒストグラム/箱ひげの確認
- セグメント別KPIの集計と比較
- 相関/クロス集計で仮説を抽出

**分析結果の業務転用**：
- 経営向け3点サマリー（要点/示唆/次アクション）
- アクション案の優先度付け（影響×実現性）
- 追跡用指標と次のデータ要件を定義


---


### 3-2 データ可視化

| 項目 | 内容 |
|------|------|
| **学習目標** | ADA機能を活用した高度なデータ可視化技術とインサイト抽出技術習得 |
| **対象機能** | ADA + Excel + グラフ作成 + 統計的可視化 |

#### 📚 この章で学ぶこと

📈 **データ可視化の戦略的重要性**

効果的なデータ可視化は、複雑なデータから瞬時に洞察を抽出し、意思決定を加速させます。
ADA機能では、単なるグラフ作成を超えて、統計的に意味のある可視化とビジネスインサイトの同時提供を実現します。

![ChatGPTでの画像生成例：富士山の風景](https://profab.co.jp/wp-content/uploads/2025/09/txt_chatgpt_fujisan.png)

💡 **ビジネスに活きるグラフ選択の基準**

ビジネスシーンで最も頻繁に使用されるグラフの選択基準です。目的に応じて適切なグラフを選択することで、データの意味を効果的に伝えることができます。

```
目的別グラフ選択ガイド:
• 比較する → 棒グラフ、レーダーチャート
• 推移を見る → 折れ線グラフ、エリアチャート
• 構成を見る → 円グラフ、積み上げ棒グラフ
• 関係を見る → 散布図、バブルチャート
• 分布を見る → ヒストグラム、箱ひげ図
```

ADA機能では、Matplotlibを用いた様々な高度な可視化技術も利用可能です。以下に主要な描画可能なグラフを紹介します。

```
その他の描画可能なグラフ:

■ 統計・分析系
• バイオリンプロット - 箱ひげ図+密度曲線で詳細な分布を表示
• ヒートマップ - 相関行列やクロス集計を色で表現
• 等高線図 - 3次元データの等高線を平面に投影
• ステムプロット - 離散データの棒状表示

■ 3次元・立体系
• 3D散布図 - X, Y, Z軸での立体表示
• 3D棒グラフ - 立体的な棒グラフ
• 3D曲面プロット - 関数の立体表示

■ 特殊・業界固有
• ドーナツグラフ - 円グラフの中央が空いた形式
• サブプロット(グリッド) - 複数グラフの一括表示
• エラーバー付きグラフ - 不確実性や誤差を表現
• ログスケールグラフ - 幅広いデータレンジでの表示
```

注：Sankeyダイアグラム、ツリーマップ、ネットワーク図、ワードクラウドなどの特殊ライブラリが必要な可視化は、標準状態では制約があります。Matplotlibでの代替実装が必要になる場合があります。

🚑 **日本語が表示できない場合の対処法**

ADA機能でグラフを作成する際、日本語の文字が正しく表示されないことがあります。以下は主な症状と対処法です。

**主な症状**
- タイトル・軸ラベル・凡例・注記などが「□□□」になる
- 負の値（−3 など）の "マイナス記号" だけが豆腐になる
- 画像を書き出すと文字が欠ける／Illustratorで開くと文字化けする

**なぜ起きる？**
- Matplotlibの標準フォント（DejaVuなど）には 日本語（CJK）グリフが無い ため
- Matplotlibは目盛りの負号に U+2212（Unicodeのマイナス） を使います。日本語フォントにこの記号が無いと負号だけ豆腐になります

**対処法**
Google fontのNoto Sans JPフォントをsampleフォルダからダウンロードし、チャット欄にアップロードして使用してください。

**参照フォントファイル**: [NotoSansJP-Regular.ttf](https://drive.google.com/file/d/1DzAsZAFy6ndEFTKbEFeGNY7kQsqaSg7Z/view?usp=sharing)

#### ハンズオン演習

> 💡 **演習の進め方**
>
> 1. 各演習の状況設定を理解する
> 2. 記載されているプロンプト例をそのまま試す
> 3. 出力結果を確認し、より良い結果を得るためにプロンプトを修正します
> 4. 演習1〜3まで完了後、ユースケース例を参考に自業務での活用を検討してください

**【演習1】**

| テーマ | 状況設定 |
|------|------|
| 統計解析と相関分析（広告費と売上の関係を見る） | 広告費と売上がどれくらい関係しているかをざっくり把握する |

**参照ファイル**: [sample_marketing_stats.csv](https://drive.google.com/file/d/1mq39aoZrnrzCMT0NxbwUNnr2RQqHZ1P6/view?usp=sharing)

**プロンプト例**:
```
sample_marketing_stats.csv を読み込み、
1) 全ての数値列の平均、中央値、標準偏差を出す
2) 広告費と売上の関係を散布図で描く
3) 広告費から売上を予測する簡単な計算をして結果を出す
```

**【演習2】**

| テーマ | 状況設定 |
|------|------|
| 重複データの自動検出と整理（商品マスタの品質改善） | 商品データの中に重複や欠けている値があるので、自動で直したい |

**参照ファイル**: [sample_data_quality.csv](https://drive.google.com/file/d/1dVu_L4D3PfqRb6-EkymHWxdczX6UXLn0/view?usp=sharing)

**プロンプト例**:
```
sample_data_quality.csv を読み込み、
1) 全く同じ行を削除して件数を出す
2) 欠けている数値を中央値で補う
3) 明らかに大きすぎる／小さすぎる値を見つけてフラグを付ける
4) 値の分布をグラフで表示する
```

**【演習3】**

| テーマ | 状況設定 |
|------|------|
| クラスタリングによる顧客グループ分け | 似た特徴の顧客を自動でグループ分けして特徴を知る |

**参照ファイル**: [sample_customer_segmentation.csv](https://drive.google.com/file/d/1T-9QzG1buFU-LcekSoRqWcIx0I_UERLd/view?usp=sharing)

**プロンプト例**:
```
sample_customer_segmentation.csv を読み込み、
1) 数値項目を使って自動で3つにグループ分けする
2) 各グループの平均値と人数を出す
3) グループごとの違いを簡単に説明する
4) グラフでグループ分けを表示する
```

※ クラスタリング＝グループ分け

**ユースケース例**：自業務への応用（テーマ別 × 各3例）

学習した内容を次も参考に自業務に生かしてください。

**目的適合のグラフ選択**：
- 比較/構成/推移に適した図を選定
- 軸・スケール・色のガイドを適用
- 誤読を防ぐ注記/基準線を追加

**ダッシュボード素案の設計**：
- KPIカード/トレンド/異常アラート
- フィルタとドリルダウンの設計
- 更新頻度とデータ源の明記

**ストーリーテリング可視化**：
- 結論→根拠→示唆の順で配置
- 一枚グラフに要点注釈を付与
- エグゼクティブサマリーを併記


---
